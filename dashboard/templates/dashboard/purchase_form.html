{% extends 'dashboard/base.html'%}
{% block title %}
Purchase Add
{% endblock %}
{% block css %}

{% endblock %}

{%block content %}

<!--<form action="" method="post" id="purchase-form1">-->

<!--    {% csrf_token %}-->

<!--    <div class="border border-primary border-bottom mx-3 container">-->

<!--        <div class="form-row mx-3 my-1">-->

<!--            <div class="form-group col-lg-5 col-md-4 col-sm-12">-->
<!--                <label for="invoice">Purchase invoice</label>-->
<!--                <div id="invoice" name="invoice">-->
<!--                    {{purchase.purchase_invoice}}-->
<!--                </div>-->
<!--            </div>-->


<!--            <div class="form-group  col-lg-5 col-md-4 col-sm-12">-->
<!--                <label for="exampleInputclientName">client Name</label>-->
<!--                <div id="exampleInputclientName" name="clien_name">-->
<!--                    {{purchase.client_name}}-->
<!--                </div>-->
<!--            </div>-->

<!--            <div class="form-group col-lg-5 col-md-4 col-sm-12">-->
<!--                <label for="exampleInputPurchaseDate">Purchase Date</label>-->
<!--                <div id="exampleInputPurchaseDate" name="purchase_date">-->
<!--                    {{purchase.purchase_date}}-->
<!--                </div>-->
<!--            </div>-->

<!--            <div class="form-group col-lg-5 col-md-4 col-sm-12">-->
<!--                <label for="exampleInputPurchaseAddress">Purchase Address</label>-->
<!--                <div id="exampleInputPurchaseAddress" name="purchas_address">-->
<!--                    {{purchase.purchase_address}}-->
<!--                </div>-->
<!--            </div>-->

<!--            <div class="form-group col-lg-5 col-md-5 col-sm-12">-->
<!--                <label for="exampleInputRefNo">Ref No</label>-->
<!--                <div id="exampleInputRefNo" name="ref_no">-->
<!--                    {{purchase.reference_no}}-->
<!--                </div>-->
<!--            </div>-->


<!--        </div>-->

<!--&lt;!&ndash;        <div class="form-row mx-3 my-1">&ndash;&gt;-->


<!--&lt;!&ndash;            <div class="form-group col-lg-6 col-md-5 col-sm-12">&ndash;&gt;-->
<!--&lt;!&ndash;                <label for="exampleInputFinaleAmount">Finale Amount</label>&ndash;&gt;-->
<!--&lt;!&ndash;                <div id="exampleInputFinaleAmount" name="final_amount">&ndash;&gt;-->
<!--&lt;!&ndash;                    {{purchase.Final_Amount}}&ndash;&gt;-->
<!--&lt;!&ndash;                </div>&ndash;&gt;-->
<!--&lt;!&ndash;            </div>&ndash;&gt;-->


<!--&lt;!&ndash;        </div>&ndash;&gt;-->


<!--    </div>-->

<!--    &lt;!&ndash;    <a class="btn btn-danger" href="{% url 'company_view'%}">Cancel</a>&ndash;&gt;-->

<!--</form>-->

<form action="" method="post" id="purchase-form2">

    {% csrf_token %}

    <div class="border border-primary border-bottom mx-3 container">
        <div class="form-row mx-3 my-1">

            <div class="form-group col-lg-2 col-md-2 col-sm-12">
                <label for="exampleInputProductCode">Product Code</label>
                <div id="exampleInputProductCode" name="product_code">
                    {{sub_purchase.product_code}}
                </div>
            </div>

            <div class="form-group col-lg-2 col-md-2 col-sm-12">
                <label for="exampleInputProductName">Product Name</label>
                <div id="exampleInputProductName" name="product_name">
                    {{sub_purchase.product_name}}
                </div>
            </div>


            <div class="form-group col-lg-2 col-md-2 col-sm-12">
                <label for="exampleInputQty">Qty</label>
                <div id="exampleInputQty" class="qtyy" name="qty">
                    {{sub_purchase.qty}}
                </div>
            </div>

            <div class="form-group col-lg-2 col-md-2 col-sm-12">
                <label for="exampleInputUnitPrice">Unit Price</label>
                <div id="exampleInputUnitPrice" name="unit_price">
                    {{sub_purchase.unit_price}}
                </div>
            </div>

            <div class="form-group col-lg-2 col-md-2 col-sm-12">
                <label for="exampleInputUnitPrice">Tax</label>
                <div id="exampleInputTax" name="tax">
                    {{sub_purchase.tax_per}}
                </div>
            </div>

            <div class="form-group col-lg-2 col-md-2 col-sm-12">
                <label for="exampleInputUnitPrice">Amount</label>
                <div id="exampleInputAmount" name="amount">
                    {{sub_purchase.amount}}
                </div>
            </div>

            <div class="form-group col-lg-2 col-md-4 col-sm-12">
                <label for="exampleInputSerial">Serial No</label>
                <div id="exampleInputSerial" name="serial_no">
                    {{sub_purchase.serial_no}}
                </div>
            </div>

        </div>

        <div class="form-row mx-3 my-1">

            <div id="param"></div>

        </div>
        <a class="btn btn-primary mx-3" id="addParam">Add New Line</a>

        <div class="form-row mx-3 my-1">


            <div class="form-group col-lg-4 col-md-5 col-sm-12 float-right">
                <label for="exampleInputSubTotal">Final Toatal</label>
                <div id="exampleInputSubTotal" name="Sub_total">
                    {{sub_purchase.sub_total}}
                </div>
            </div>


        </div>


    </div>
    <button type="submit" class="btn btn-primary my-1 mx-3" id="submit">Add</button>


</form>






{% block javascript %}
<script>


$(document).ready(function(){

$("#addParam").click( function(){
let addParamCount=0;
 let string =`
    <div class="form-row mx-1">
         <div class="form-group col-lg-2 col-md-2 col-sm-12">
            <label for="exampleInputProductCode">Product Code ${addParamCount + 2}</label>
            <div id="exampleInputProductCode" name="product_code">
                {{sub_purchase.product_code}}
            </div>
        </div>
        <div class="form-group col-lg-2 col-md-2 col-sm-12">
            <label for="exampleInputProductName">Product Name</label>
            <div id="exampleInputProductName" name="product_name">
                {{sub_purchase.product_name}}
            </div>

        </div>
        <div class="form-group col-lg-2 col-md-2 col-sm-12">
            <label for="exampleInputQty">Qty</label>
            <div id="exampleInputQty" name="qty">
                {{sub_purchase.qty}}
            </div>
        </div>
        <div class="form-group col-lg-2 col-md-2 col-sm-12">
            <label for="exampleInputUnitPrice">Unit Price</label>
            <div id="exampleInputUnitPrice" name="unit_price">
                {{sub_purchase.unit_price}}
            </div>
        </div>
        <div class="form-group col-lg-2 col-md-2 col-sm-12">
            <label for="exampleInputUnitPrice">Tax</label>
            <div id="exampleInputTax" name="tax">
                {{sub_purchase.tax_per}}
            </div>
        </div>
        <div class="form-group col-lg-2 col-md-2 col-sm-12">
            <label for="exampleInputUnitPrice">Amount</label>
            <div id="exampleInputAmount" name="amount">
                {{sub_purchase.amount}}
            </div>
        </div>
        <div class="form-group col-lg-2 col-md-4 col-sm-12">
            <label for="exampleInputSerial">Serial No</label>
            <div id="exampleInputSerial" name="serial_no">
                {{sub_purchase.serial_no}}
            </div>
        </div>
        <button class="btn btn-danger deleteParam">-</button>
    </div> `;

        $("#param").append(string);
  addParamCount++;
$(document).on('click','.deleteParam' ,function(e){

   e.preventDefault();
   $(this).parent('div').remove();

});

});


$("#purchase-form2").submit( function(e){
    e.preventDefault();
    var serializedData = $(this).serialize();
    $.ajax({
    method:'POST',
    url: "{% url 'purchase_form' %}",
    data:serializedData,
    success:function(data)
    {
     alert(data);
      $("#purchase_form")[0].reset();


    }


    });


});



});






</script>

{% endblock %}

{% endblock%}


